upstream flask {
    server unix:///tmp/upload.sock;
}

server {

        client_max_body_size 1000M;

        root /var/www/{{site_fqdn}};

        server_name {{site_fqdn}};

        location /bin/ {
                deny all;
        }

        location /return/ {
        }

        location /upload/ {
                include uwsgi_params;
                uwsgi_pass flask;
        }

        location /preview/ {
                include uwsgi_params;
                uwsgi_pass flask;
        }

        location /advpreview/ {
                include uwsgi_params;
                uwsgi_pass flask;
        }

        location /derot/ {
                include uwsgi_params;
                uwsgi_pass flask;
        }

        location /advderot/ {
                include uwsgi_params;
                uwsgi_pass flask;
        }

        location /count/ {
                include uwsgi_params;
                uwsgi_pass flask;
        }

        location / {
                index index.html;
        }

        listen 80;
}
